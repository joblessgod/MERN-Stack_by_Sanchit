<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo API</title>
    <link rel="stylesheet" href="todos-api.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
    <form>
        <input required id="title" type="text"> <button>Submit</button>
    </form>
    <hr>
    <ul id="todos-api-list">
        <li>html</li>
        <li>css</li>
    </ul>
    <script>
        let todos = []
        function createTodoAPI(e) {
            e.preventDefault();
            axios.post("https://todo-api-dom.vercel.app/api/todos/", {
                title: document.getElementById("title").value
            })
                .then((resp) => {
                    fetchTodos()
                })
        }
        
        function fetchTodos() {
            axios.get("https://todo-api-dom.vercel.app/api/todos")
            .then((resp) => {
                console.log(resp.data.data);
                
                let printOutput = ``;
                resp.data.data.forEach(el => {
                    printOutput += `<li> ${el.title}</li> <button onclick = "toggleStatus('${el._id}')">${el.status}</button>`
                })
                
                // printOutput += `<li>${resp.data.data}</li>`
                document.getElementById("todos-api-list").innerHTML = printOutput;
                // todos.push(resp.data.data) // FROM HERE <---
                })

                .catch(err => {
                    console.log(err);
                    document.getElementById("todos-api-list").innerHTML = "Sanchit, Try Again"
                })

        }
        fetchTodos()
        function toggleStatus(_id) {
            console.log("todo_id",_id);
            console.log(todos);
            axios.put("https://todo-api-dom.vercel.app/api/todos/"+_id, {
                status: ! todos.find(el => el._id == _id).status
            }).then((resp) => {
                    fetchTodos()
                })
        }
    </script>
</body>

</html>